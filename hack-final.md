#第二届众安黑客松大赛区块链赛道

内容简介

##背景知识

本次开发大赛将全程基于 AnnChain 的开源项目 OG 进行开发。选手需要了解 OG 的基本结构以及交易在 OG 上的确认方式。

#### DAG 结构的账本

在传统区块链结构中，交易信息会被打包进一个区块，区块之间以链式连接，形成一个区块链式的账本。

![区块链式结构](./区块链式结构.png)

**区块链特点 暂缺**

与之相对的，Dag (Directed acyclic graph) 有向五环图结构的账本则是将所有的区块打散，使交易与交易之间直接相连。通过交易来确认交易，保障交易哈希的不可篡改性。

![dag结构](./dag结构.png)

对比区块链结构的账本，dag能拥有更大的灵活性和可扩展性。不会因为矿工出块过慢卡住整个网络从而无法发送交易。

**更多的DAG特点 暂缺**

#### OG

tx结构

seq

og的特点，tip，tx_pool, dag, 

**更多的OG特点暂缺**

##规则

Dag的图结构使得交易之间存在一种直接的连接关系。在OG中，这种连接关系保证了交易hash间的关联。那么能否利用这种关联关系来增加区块链系统的可玩性呢？

有基于此，在本次黑客松中我们对这种交易间的父子关系增加了一个特殊的效果：

**前序交易parent会被后序交易child抢走部分资金**

![抢劫简单示例图](/Users/heeeeng/资料/众安/2019黑客松/决赛/文档/抢劫简单示例图.png)

如图所示，如果 `Tx03` 的 parents 为 `Tx01` 和`Tx02`，则 `Tx03` 会抢走它 parents 交易`Tx01` 和 `Tx02`的部分资金。

围绕这个规则，我们重新开发了OG并制定了一整套游戏玩法：

####规则1. 争抢空投

每个Sequencer都会有一个 `treasure` 字段，表示空投的金额。如果 Seq 被普通交易tx认作parent，则此 tx 会抢走`treasure`的资金。

![抢钱规则01](/Users/heeeeng/资料/众安/2019黑客松/决赛/文档/抢钱规则01.png)

如果有多个 交易tx 将此 Seq 认作 parent，则所有的这些 tx 共同瓜分 `treasure` 。为了明确瓜分的比例，所有的tx必须提供一个`guarantee` 保证金字段，根据各个交易tx的保证金比例来决定瓜分的比例：

![抢钱规则02](/Users/heeeeng/资料/众安/2019黑客松/决赛/文档/抢钱规则02.png)

如上图，tx01的保证金是 100，tx02 的保证金是 300。所以tx01抢走 1/4 的`treasure`，也就是 250；tx02 抢走 3/4 的 `treasure` 也就是 750。

####规则2. Rob

如果普通交易tx01被其他交易认作 parent，则 tx01**从 parents 抢到的钱**和**它自己的保证金**都会以一定比例被其child 抢走。在我们的系统中，这个比例是 30%。

![规则02.01](/Users/heeeeng/资料/众安/2019黑客松/决赛/hack_doc/规则02.01.png)

如上图，假设tx01已经从它的parents中抢得 1000。此后它被 tx02 和 tx03 跟随，那么tx01 抢到的钱和保证金就会被`tx02`和`tx03`瓜分掉30%。

`tx01` 抢到了 1000，保证金是 100，所以最后会被后序交易抢走 `1000*30%+100*30%=330`。由于`tx02`和`tx03`的保证金都是100，所以他们每人抢得金额为`330*(1/2)=165`。

#### 规则3. 查封和清算

- **查封：**每个Sequencer除了扮演新一轮的空投角色外，还要负责上一轮的查封和清算工作。当 Sequencer 产生时，它会将当前所有未被其他交易跟随的 tips 都认作自己的parent。所有最后被sequencer跟随的交易都会被Sequencer抢走部分资金，抢钱逻辑和**规则2**一致，但是被抢的比例为两倍既 **60%**。我们称这个过程查封。

  ![规则03.01](/Users/heeeeng/资料/众安/2019黑客松/决赛/hack_doc/规则03.01.png)

  如图所示，tx01 会被seq抢走 `1000*60% + 100*60% = 660`, tx02 和 tx03 同理。

- **清算：**每一轮游戏都以一个新的seq产生做为开始，以下一个新的seq产生做为结束。只有等下一个seq产生时，本轮的所有收益或者支出才会进行结算。所有被查封的金额全都会被销毁，不会计入任何人的账户中。







#### 评判标准

每队伍分配一个private key，内有一部分启动资金。

比赛结束时余额最多的队伍获得胜利。



##开发细节

- 每个队伍会分配一个token，用于操作sdk。
- 部分api会有请求限制，每分钟只能请求固定数量（列出详细API）
- 提供 GO / PYTHON / JAVA 的SDK
- 具体开发流程示例（伪代码）

